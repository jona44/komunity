<!-- Lightbox Modal -->
<dialog id="lightbox_modal" class="modal bg-black/90">
  <div class="modal-box bg-transparent shadow-none max-w-5xl w-full p-0 relative flex items-center justify-center h-full">
    
    <!-- Close Button -->
    <form method="dialog" class="absolute top-4 right-4 z-50">
      <button class="btn btn-circle btn-ghost text-white hover:bg-white/20">
        <span class="material-icons text-3xl">close</span>
      </button>
    </form>

    <!-- Navigation Buttons -->
    <button id="prev-btn" class="absolute left-4 top-1/2 -translate-y-1/2 z-50 btn btn-circle btn-ghost text-white hover:bg-white/20 hidden" onclick="changeImage(-1)">
      <span class="material-icons text-4xl">chevron_left</span>
    </button>
    
    <button id="next-btn" class="absolute right-4 top-1/2 -translate-y-1/2 z-50 btn btn-circle btn-ghost text-white hover:bg-white/20 hidden" onclick="changeImage(1)">
      <span class="material-icons text-4xl">chevron_right</span>
    </button>

    <!-- Image Container -->
    <div class="relative w-full h-full flex items-center justify-center p-4">
      <img id="lightbox-image" src="" alt="Full size media" class="max-h-[90vh] max-w-full object-contain rounded-lg shadow-2xl">
    </div>
  </div>
  
  <!-- Backdrop click to close -->
  <form method="dialog" class="modal-backdrop">
    <button>close</button>
  </form>
</dialog>

<script>
  let currentImages = [];
  let currentIndex = 0;

  function openLightbox(index, images) {
    // If images is a string, convert to single-item array (backward compatibility)
    if (typeof images === 'string') {
      images = [images];
      index = 0;
    }
    
    currentIndex = index;
    currentImages = images;
    updateLightbox();
    document.getElementById('lightbox_modal').showModal();
  }

  function changeImage(direction) {
    currentIndex = (currentIndex + direction + currentImages.length) % currentImages.length;
    updateLightbox();
  }

  function updateLightbox() {
    const img = document.getElementById('lightbox-image');
    img.src = currentImages[currentIndex];
    
    // Toggle navigation buttons
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    
    if (currentImages.length > 1) {
      prevBtn.classList.remove('hidden');
      nextBtn.classList.remove('hidden');
    } else {
      prevBtn.classList.add('hidden');
      nextBtn.classList.add('hidden');
    }
  }
  
  // Keyboard navigation
  document.addEventListener('keydown', (e) => {
    const modal = document.getElementById('lightbox_modal');
    if (modal.open) {
      if (e.key === 'ArrowLeft') changeImage(-1);
      if (e.key === 'ArrowRight') changeImage(1);
    }
  });
</script>
